<div class="thin-row">
  <h4>Here's who's requested to be on your team</h4>

  <p>
  Please review all the applications as soon as possible. You don't have to accept everyone onto your team. If you feel someone's not a good fit, you can reject them and we'll just tell them to search for a different team. You can also ask people who have applied for a role you've already filled to apply for a different role.
  </p>
  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Team role</th>
          <th>Name</th>
          <th>Email</th>
          <th>Dashboard</th>
        </tr>
      </thead>
      <tbody>
      <% @team.role_applications.select {|r| !r.approved?}.sort_by { |r| r.rejected? ? 1 : 0 }.each do |r| %>
        <tr class="<%= 'strikethrough' if r.rejected? %>">
          <td><%= r.role.capitalize %></td>
          <td><%= r.user.name %></td>
          <td><%= r.user.email %></td>
          <td><%= r.tasks.where(:done => true).count %> of <%= r.tasks.count %> tasks done </td>
          <td>
            <%= link_to 'Remove From Team', cancel_role_application_path(@team.id, r.id),
            :method => :delete, :confirm => 'Are you sure you want to remove this person from your team?',
            :class => 'btn btn-sm btn-danger' %>
          </td>
          <td><%= link_to 'Reassign', reassign_path(@team.id, r.id), :class => 'btn btn-sm btn-danger' unless @team.role_applications.select { |application| application.approved? }.count >= 3 %></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>
